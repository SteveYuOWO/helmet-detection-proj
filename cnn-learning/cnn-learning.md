# CNN learning

### â¤ï¸Introduction

é¡¹ç›®è¯¾é¢˜åŸºäºCNNä»‹ç»

### ğŸ§¡What Keras?

**Keras**æ˜¯ä¸€ä¸ªç”¨Pythonç¼–å†™çš„å¼€æºç¥ç»ç½‘ç»œåº“ã€‚è®¾è®¡ç”¨äºå®ç°æ·±åº¦ç¥ç»ç½‘ç»œçš„å¿«é€Ÿå®éªŒï¼Œå®ƒçš„é‡ç‚¹æ˜¯ç”¨æˆ·å‹å¥½ï¼Œæ¨¡å—åŒ–å’Œå¯æ‰©å±•ã€‚å®ƒæ˜¯ONEIROSï¼ˆå¼€æ”¾å¼ç¥ç»ç”µå­æ™ºèƒ½æœºå™¨äººæ“ä½œç³»ç»Ÿï¼‰é¡¹ç›®ç ”ç©¶å·¥ä½œçš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸»è¦ä½œè€…å’Œç»´æŠ¤è€…æ˜¯Googleçš„FranÃ§oisCholletå·¥ç¨‹å¸ˆã€‚Cholletè¿˜æ˜¯XCeptionæ·±åº¦ç¥ç»ç½‘ç»œæ¨¡å‹çš„ä½œè€…ã€‚

ä¸‹é¢çš„æ¡ˆä¾‹æˆ‘ä»¬ä¼šäº†è§£Kerasåœ¨ç¥ç»ç½‘ç»œç¼–ç¨‹çš„æ–¹ä¾¿æ€§

### ğŸ§¡What CNN?

ç¥ç»ç½‘ç»œç”±ä¸€è¿ä¸²çš„ç¥ç»å±‚ç»„æˆï¼Œæ¯ä¸€å±‚å­˜åœ¨å¾ˆå¤šç¥ç»å…ƒã€‚

æ¯ä¸€ä¸ªç¥ç»ç½‘ç»œéƒ½æœ‰è¾“å…¥å’Œè¾“å‡ºå€¼ã€‚

ğŸ¤ ä¸¾ä¾‹ï¼šLinear Regression

âš™ï¸è¿™ä¸ªæ–‡ä»¶æˆ‘è¿›è¡Œäº†è¯¦ç»†çš„æ ‡æ³¨ã€‚[keras_test/regression.py](regression.py) 

ğŸ¤ ä¸¾ä¾‹ï¼šImage Classification

å›¾ç‰‡è¯†åˆ«çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ˜¯è‰²å½©ç¼¤çº·çš„å›¾æ¡ˆï¼Œè€Œæ˜¯ä¸€å †å †çš„æ•°å­—ã€‚å½“ç¥ç»ç½‘ç»œéœ€è¦å¤„ç†ä¿¡æ¯çš„æ—¶å€™ï¼Œå³æ˜¯å‘æŒ¥ä¼˜åŠ¿çš„æ—¶å€™ã€‚

âœ…å·ç§¯ä¸å†å¯¹æ¯ä¸ªåƒç´ è¿›è¡Œå¤„ç†ï¼Œè€Œæ˜¯å¯¹æ¯ä¸€å°å—åŒºåŸŸè¿›è¡Œå¤„ç†ã€‚âœ…è¿™æ ·å¢å¼ºäº†å›¾ç‰‡ä¿¡æ¯çš„è¿ç»­æ€§ï¼Œä½¿å¾—ç¥ç»ç½‘ç»œèƒ½çœ‹åˆ°å›¾å½¢ï¼Œè€Œéä¸€ä¸ªç‚¹ã€‚âœ…å…·ä½“æ¥è¯´ï¼Œå·ç§¯ç¥ç»ç½‘ç»œæœ‰ä¸€ä¸ªæ‰¹é‡è¿‡æ»¤å™¨ã€‚

âš™ï¸è‡ªå¸¦çš„mnistè®­ç»ƒå›¾ç‰‡è¯†åˆ«ã€‚[keras_test/classify-simple](classify-simple.py) 

### ğŸ’›What IC & OD?

âœ…Image Classification: å›¾åƒè¯†åˆ«ï¼Œå¯¹å•å›¾è¿›è¡Œè¯†åˆ«ã€‚æ¯”å¦‚ï¼šè¯†åˆ«å›¾ç‰‡çŒ«ã€è¯†åˆ«å›¾ç‰‡å°ç‹—

âœ…Object Detection: ç‰©ä½“æ£€æµ‹ï¼Œå¯¹å›¾ç‰‡ä¸­ç‰©ä½“è¿›è¡Œæ£€æµ‹ã€‚æ¯”å¦‚ï¼šè¯†åˆ«å›¾ç‰‡ä¸­çš„é£Ÿç‰©ã€è¡£ç‰©ã€‚

å®é™…ä¸Šã€‚æˆ‘ä»¬æƒ³å¯¹å®‰å…¨å¸½è¿›è¡Œçš„æ˜¯Object Detectionçš„å·¥ä½œ

### ğŸ’šHow CNN?

è‡ªç„¶ï¼Œæˆ‘ä»¬çŸ¥é“äº†ç°ä»£åŒ–çš„æ¡†æ¶ï¼Œä¾‹å¦‚Keraså¯ä»¥è®©æ·±åº¦å­¦ä¹ å˜ç®€å•ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦äº†è§£æ·±åº¦å­¦ä¹ æµç¨‹ã€‚

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227024749399-985580982.png)

è¿™å¼ å›¾å¾ˆå¥½æè¿°äº†æµç¨‹ã€‚

 **âœ…æ•°æ®è¾“å…¥å±‚/Input layer**

æˆ‘ä»¬å·¦è¾¹çš„å›¾ç‰‡è¾“å…¥æ˜¯Input layerå¤„ç†å›¾ç‰‡çš„è¾“å…¥ã€‚

è¿™è¾¹ï¼Œæˆ‘ä»¬è¦å¤„ç†çš„æ˜¯å›¾ç‰‡çš„å»å‡å€¼ã€å½’ä¸€åŒ–ã€å»ç›¸å…³ã€ç™½åŒ–æ“ä½œ

- ğŸ¤ å»å‡å€¼ï¼šæŠŠè¾“å…¥æ•°æ®å„ä¸ªç»´åº¦éƒ½ä¸­å¿ƒåŒ–ä¸º0ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ç›®çš„å°±æ˜¯æŠŠæ ·æœ¬çš„ä¸­å¿ƒæ‹‰å›åˆ°åæ ‡ç³»åŸç‚¹ä¸Šã€‚
- ğŸ¤ å½’ä¸€åŒ–ï¼šå¹…åº¦å½’ä¸€åŒ–åˆ°åŒæ ·çš„èŒƒå›´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå³å‡å°‘å„ç»´åº¦æ•°æ®å–å€¼èŒƒå›´çš„å·®å¼‚è€Œå¸¦æ¥çš„å¹²æ‰°ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªç»´åº¦çš„ç‰¹å¾Aå’ŒBï¼ŒAèŒƒå›´æ˜¯0åˆ°10ï¼Œè€ŒBèŒƒå›´æ˜¯0åˆ°10000ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªç‰¹å¾æ˜¯æœ‰é—®é¢˜çš„ï¼Œå¥½çš„åšæ³•å°±æ˜¯å½’ä¸€åŒ–ï¼Œå³Aå’ŒBçš„æ•°æ®éƒ½å˜ä¸º0åˆ°1çš„èŒƒå›´ã€‚
- ğŸ¤ PCA/ç™½åŒ–ï¼šç”¨PCAé™ç»´ï¼›ç™½åŒ–æ˜¯å¯¹æ•°æ®å„ä¸ªç‰¹å¾è½´ä¸Šçš„å¹…åº¦å½’ä¸€åŒ–

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227025436057-730971864.png)



![image-20200227025456202](/Users/steveyu/Library/Application Support/typora-user-images/image-20200227025456202.png)

 **âœ…å·ç§¯è®¡ç®—å±‚/CONV layer**

è¿™ä¸€å±‚å°±æ˜¯å·ç§¯ç¥ç»ç½‘ç»œæœ€é‡è¦çš„ä¸€ä¸ªå±‚æ¬¡ï¼Œä¹Ÿæ˜¯â€œå·ç§¯ç¥ç»ç½‘ç»œâ€çš„åå­—æ¥æºã€‚
åœ¨è¿™ä¸ªå·ç§¯å±‚ï¼Œæœ‰ä¸¤ä¸ªå…³é”®æ“ä½œï¼š

- å±€éƒ¨å…³è”ã€‚æ¯ä¸ªç¥ç»å…ƒçœ‹åšä¸€ä¸ªæ»¤æ³¢å™¨(filter)
- çª—å£(receptive field)æ»‘åŠ¨ï¼Œ filterå¯¹å±€éƒ¨æ•°æ®è®¡ç®—

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227025617295-1875760932.png)

**âœ… æ¿€åŠ±å±‚/Activation layer**

æŠŠå·ç§¯å±‚è¾“å‡ºç»“æœåšéçº¿æ€§æ˜ å°„ã€‚

CNNé‡‡ç”¨çš„æ¿€åŠ±å‡½æ•°ä¸€èˆ¬ä¸ºReLU(The Rectified Linear Unit/ä¿®æ­£çº¿æ€§å•å…ƒ)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ”¶æ•›å¿«ï¼Œæ±‚æ¢¯åº¦ç®€å•ï¼Œä½†è¾ƒè„†å¼±ï¼Œå›¾åƒå¦‚ä¸‹ã€‚

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227025928589-443439138.png)

æ¿€åŠ±å±‚çš„å®è·µç»éªŒï¼š

- â‘ ä¸è¦ç”¨sigmoidï¼ä¸è¦ç”¨sigmoidï¼ä¸è¦ç”¨sigmoidï¼
- â‘¡ é¦–å…ˆè¯•RELUï¼Œå› ä¸ºå¿«ï¼Œä½†è¦å°å¿ƒç‚¹
- â‘¢ å¦‚æœ2å¤±æ•ˆï¼Œè¯·ç”¨Leaky ReLUæˆ–è€…Maxout
- â‘£ æŸäº›æƒ…å†µä¸‹tanhå€’æ˜¯æœ‰ä¸é”™çš„ç»“æœï¼Œä½†æ˜¯å¾ˆå°‘

**âœ… æ± åŒ–å±‚/Pooling layer**

æ± åŒ–å±‚å¤¹åœ¨è¿ç»­çš„å·ç§¯å±‚ä¸­é—´ï¼Œ ç”¨äºå‹ç¼©æ•°æ®å’Œå‚æ•°çš„é‡ï¼Œå‡å°è¿‡æ‹Ÿåˆã€‚
ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœè¾“å…¥æ˜¯å›¾åƒçš„è¯ï¼Œé‚£ä¹ˆæ± åŒ–å±‚çš„æœ€ä¸»è¦ä½œç”¨å°±æ˜¯å‹ç¼©å›¾åƒã€‚

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227030055296-1820233911.png)

æ± åŒ–å±‚ç”¨çš„æ–¹æ³•æœ‰Max pooling å’Œ average poolingï¼Œè€Œå®é™…ç”¨çš„è¾ƒå¤šçš„æ˜¯Max poolingã€‚

è¿™é‡Œå°±è¯´ä¸€ä¸‹Max poolingï¼Œå…¶å®æ€æƒ³éå¸¸ç®€å•ã€‚

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227030122648-536118045.png)

å¯¹äºæ¯ä¸ª2\*2çš„çª—å£é€‰å‡ºæœ€å¤§çš„æ•°ä½œä¸ºè¾“å‡ºçŸ©é˜µçš„ç›¸åº”å…ƒç´ çš„å€¼ï¼Œæ¯”å¦‚è¾“å…¥çŸ©é˜µç¬¬ä¸€ä¸ª2\*2çª—å£ä¸­æœ€å¤§çš„æ•°æ˜¯6ï¼Œé‚£ä¹ˆè¾“å‡ºçŸ©é˜µçš„ç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯6ï¼Œå¦‚æ­¤ç±»æ¨ã€‚

**âœ… å…¨è¿æ¥å±‚/Full Connection**

ä¸¤å±‚ä¹‹é—´æ‰€æœ‰ç¥ç»å…ƒéƒ½æœ‰æƒé‡è¿æ¥ï¼Œé€šå¸¸å…¨è¿æ¥å±‚åœ¨å·ç§¯ç¥ç»ç½‘ç»œå°¾éƒ¨ã€‚ä¹Ÿå°±æ˜¯è·Ÿä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œç¥ç»å…ƒçš„è¿æ¥æ–¹å¼æ˜¯ä¸€æ ·çš„

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227030248875-1746334058.png)

**ä¸€èˆ¬æµç¨‹:**

```
1. INPUT
2. [[CONV -> RELU]*N -> POOL?]*M
3. [FC -> RELU]*K
4. FC
```

### ğŸ’™Object Detection Technology

Object Detection æŠ€æœ¯çš„æ¼”è¿›ï¼š

```
RCNN -> SppNET -> Fast-RCNN ->Faster-RCNN
```

è¿™æ®µä¸è¿‡å¤šä»‹ç»ï¼ŒObject Detection åŸç†åŸºäº Image Classificationï¼Œç®€å•è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾æ‰€æœ‰å¯èƒ½çš„Objectè¿›è¡ŒImage Classificationï¼Œç§‘å­¦å®¶å‘æ˜å¥½å¤šé€‰å®šå€™é€‰æ¡†çš„æ–¹æ³•ï¼Œæ¯”å¦‚EdgeBoxeså’ŒSelective Searchã€‚

ä»¥ä¸‹æ˜¯å„ç§é€‰å®šå€™é€‰æ¡†çš„æ–¹æ³•çš„æ€§èƒ½å¯¹æ¯”ã€‚

![](https://img2018.cnblogs.com/blog/1449595/202002/1449595-20200227031353286-708646793.png)

ç›®å‰Faster-RCNNèƒ½å¤Ÿè¾¾åˆ°è§†é¢‘æµå¤„ç†çš„æ•ˆæœ

### â¤ï¸å‚è€ƒæ–‡çŒ®

- [è«çƒ¦Python blog](https://morvanzhou.github.io/)

- [å† å†›çš„è¯•ç‚¼: å·ç§¯ç¥ç»ç½‘ç»œCNNæ€»ç»“](https://www.cnblogs.com/skyfsm/p/6790245.html)
- [Keras Documention](https://keras.io/)
- [åŸºäºæ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ£€æµ‹æŠ€æœ¯æ¼”è¿›](https://www.cnblogs.com/skyfsm/p/6806246.html)

